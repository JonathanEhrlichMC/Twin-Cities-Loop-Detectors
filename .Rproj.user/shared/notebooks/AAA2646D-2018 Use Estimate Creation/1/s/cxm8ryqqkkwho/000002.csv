"0","# Calculate days in the summer season for the year"
"0","memorial_labor <- as.data.frame(RQuantLib::getHolidayList(calendar = 'UnitedStates', from = as_date(ymd('20180501')), to = as_date(ymd('20180930')), includeWeekends = FALSE))"
"0","summer_days <- memorial_labor %>%"
"0","  rename(Date = 1) %>%"
"0","  slice(-2) %>% # remove Fourth of July"
"0","  mutate(row_id = row_number()) %>%"
"0","  mutate(Holiday = ifelse(row_id == 1, 'Memorial_Day',"
"0","                          'Labor_Day')) %>%"
"0","  select(-row_id) %>%"
"0","  spread(Holiday, value = Date) %>%"
"0","  mutate(Memorial_Day_Saturday = as_date(ymd(Memorial_Day))- days(2)) %>% # Summer season begins the Saturday before Memorial Day"
"0","  mutate(Season_period = as.period(interval(start = as_date(ymd(Memorial_Day_Saturday)),"
"0","                                            end = as_date(ymd(Labor_Day))),"
"0","                                   unit = 'day')) %>%"
"0","  separate(Season_period, into = c('Season_days', ""HMS_in_season""),"
"0","           sep = 'd') %>%"
"0","  mutate(Half_of_summer = (as.numeric(Season_days)/2)) %>%"
"0","  mutate(Midpoint_of_summer = as_date(ymd(Memorial_Day_Saturday)) + days(Half_of_summer))"
"0","# Calculate number of weekend/holiday days and number of weekdays in summer season - this "
"0","day_type_counts <- as.data.frame(seq(as.Date(summer_days$Memorial_Day_Saturday),"
"0","                                     as.Date(summer_days$Labor_Day), ""days"")) %>%"
"0","  rename(Date = 1) %>%"
"0","  mutate(Holiday = RQuantLib::isHoliday(calendar = ""UnitedStates"","
"0","                                        dates = Date)) %>%"
"0","  mutate(Day_type = ifelse(Holiday == 'TRUE',"
"0","                           'Weekends_holidays',"
"0","                           'Weekdays')) %>%"
"0","  group_by(Day_type) %>%"
"0","  count() %>%"
"0","  spread(Day_type, value = n)"
"0","# Assign which half of the summer the day falls in; assign day-type variable; assign number of days of that day-type in the season (this number is used as a multiplier to scale counts up)"
"0","step_II <- agencies_bound %>%"
"0","  mutate(Year = ifelse(is.na(Year), '2018', Year)) %>% # Some agencies don't enter the year; fill in for them"
"0","  mutate(Month_unite = Month,"
"0","         Day_unite = Day,"
"0","         Year_unite = Year) %>%"
"0","  unite(Date, Month_unite, "
"0","        Day_unite, "
"0","        Year_unite, "
"0","        sep = "" "") %>%"
"0","  mutate(Date = as_date(mdy(Date))) %>%"
"0","  mutate(Half_of_summer = ifelse(Date <= summer_days$Midpoint_of_summer,"
"0","                                 1, 2)) %>% "
"0","  unite(Date_year, Month, Day, Year, sep = '-') %>%"
"0","  mutate(Date_object = as_date(mdy(Date_year))) %>%"
"0","  mutate(Holiday = RQuantLib::isHoliday(calendar = ""UnitedStates"","
"0","                                        dates = Date_object)) %>%"
"0","  mutate(Day_type = ifelse(Holiday == 'TRUE',"
"0","                           'Weekend_holiday', 'Weekday')) %>%"
"0","  mutate(Total_days_by_type = ifelse(Day_type == 'Weekend_holiday',"
"0","                                     day_type_counts$Weekends_holidays, day_type_counts$Weekdays)) %>%"
"0","  select(-Holiday) %>%"
"0","  mutate(Park_trail = ifelse(Park_trail == 'Minnesota River Greenway',"
"0","                             'Minnesota River Greenway Regional Trail',"
"0","                             Park_trail)) %>% # this line could possibly be removed"
"0","  mutate(Start_time = as.character(Start_time_fmt)) %>%"
"0","  select(-Start_time_fmt)"
